# Archive by removing the "inbox" label.
# -then-hide means it will also do a quasi-delete so that neomutt
# hides the mail on the next sync-mailbox command.
macro index,pager e "<modify-labels-then-hide>-inbox\n" "remove from inbox"
macro index,pager u "<modify-labels-then-hide>+inbox\n" "add to inbox"
macro index,pager "\ej" "<modify-labels-then-hide>+spam -inbox\n" "mark as spam"

# We delete very rarely indeed, so make sure we don't do this by accident.
# It requires adding the 'trash' label.
unbind index,pager d

macro index,pager g$ "<change-folder>^<enter>" "refresh vfolder"

macro index,pager A "<pipe-message>notmuch-search-id<return><enter-command>source $NOTMUCH_THREAD_QUERY<return>" "vfolder query for other messages with the same id as this email"

# If inbox flag is removed, show a "D" character as if it's deleted
#set index_format='%Z%<GI?I&a>%4C %<[y?%<[m?%<[d?%[ %H:%M]&%[%a %d]>&%[%b %d]>&%[%b%Y]> %-18.18f %s%>  %g %c'
set index_format='%Z%<GI?I&a>%4C %@date@ %-18.18f %s%>  %g %c'

unhook fcc-save-hook fcc-hook save-hook
save-hook . "$NOTMUCH_DIR/to-upload"
fcc-hook . "$my_notmuch_upload_folder"
